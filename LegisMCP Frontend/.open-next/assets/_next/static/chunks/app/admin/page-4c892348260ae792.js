(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{7799:function(e,s,a){Promise.resolve().then(a.bind(a,4556))},5131:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9763).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},4556:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return V}});var t=a(7437),l=a(2265),r=a(6824),n=a(9376),i=a(6518),c=a(9820),d=a(7168),o=a(2381),x=a(5937),m=a(2252),u=a(9763);let h=(0,u.Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);var f=a(4401),j=a(8226),p=a(6221),v=a(3804),g=a(9174),N=a(279),b=a(5291),y=a(2431);let w=(0,u.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),k=(0,u.Z)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var S=a(2369);let C=(0,u.Z)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),Z=(0,u.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var R=a(407),_=a(5710),P=a(2060);function A(e){let{onUpdate:s}=e,[a,r]=(0,l.useState)([]),[n,i]=(0,l.useState)(!0),[d,x]=(0,l.useState)(""),[m,u]=(0,l.useState)("all"),[h,f]=(0,l.useState)("all"),[p,A]=(0,l.useState)(1),[U,T]=(0,l.useState)(1),[Q,M]=(0,l.useState)(null),z=(0,l.useCallback)(async()=>{try{i(!0);let e=new URLSearchParams({page:p.toString(),search:d,plan:m,status:h}),s=await fetch("/api/admin/users?".concat(e));if(s.ok){let e=await s.json();r(e.users),T(e.totalPages)}}catch(e){console.error("Error loading users:",e)}finally{i(!1)}},[d,m,h,p]);(0,l.useEffect)(()=>{z()},[z]);let O=async(e,a)=>{M("plan-".concat(e));try{(await fetch("/api/admin/users/".concat(e,"/plan"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({planSlug:a})})).ok&&(await z(),null==s||s())}catch(e){console.error("Error updating plan:",e)}finally{M(null)}},Y=async e=>{if(confirm("Are you sure you want to cancel this subscription?")){M("cancel-".concat(e));try{(await fetch("/api/admin/users/".concat(e,"/cancel"),{method:"POST"})).ok&&(await z(),null==s||s())}catch(e){console.error("Error canceling subscription:",e)}finally{M(null)}}},D=e=>{let s={free:{variant:"secondary",label:"Free"},active:{variant:"default",label:"Active"},canceled:{variant:"outline",label:"Canceled"},past_due:{variant:"destructive",label:"Past Due"},trialing:{variant:"secondary",label:"Trial"}}[e]||{variant:"outline",label:e};return(0,t.jsx)(g.C,{variant:s.variant,children:s.label})};return(0,t.jsxs)(c.Zb,{children:[(0,t.jsx)(c.Ol,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c.ll,{children:"User Management"}),(0,t.jsx)(c.SZ,{children:"View and manage all platform users"})]}),(0,t.jsxs)(o.z,{onClick:z,size:"sm",variant:"outline",children:[(0,t.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),(0,t.jsxs)(c.aY,{children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,t.jsx)(N.I,{placeholder:"Search by name or email...",value:d,onChange:e=>x(e.target.value),className:"pl-10"})]})}),(0,t.jsxs)(b.Ph,{value:m,onValueChange:u,children:[(0,t.jsx)(b.i4,{className:"w-[180px]",children:(0,t.jsx)(b.ki,{placeholder:"Filter by plan"})}),(0,t.jsxs)(b.Bw,{children:[(0,t.jsx)(b.Ql,{value:"all",children:"All Plans"}),(0,t.jsx)(b.Ql,{value:"free",children:"Free"}),(0,t.jsx)(b.Ql,{value:"starter",children:"Developer"}),(0,t.jsx)(b.Ql,{value:"professional",children:"Professional"}),(0,t.jsx)(b.Ql,{value:"enterprise",children:"Enterprise"})]})]}),(0,t.jsxs)(b.Ph,{value:h,onValueChange:f,children:[(0,t.jsx)(b.i4,{className:"w-[180px]",children:(0,t.jsx)(b.ki,{placeholder:"Filter by status"})}),(0,t.jsxs)(b.Bw,{children:[(0,t.jsx)(b.Ql,{value:"all",children:"All Status"}),(0,t.jsx)(b.Ql,{value:"free",children:"Free"}),(0,t.jsx)(b.Ql,{value:"active",children:"Active"}),(0,t.jsx)(b.Ql,{value:"canceled",children:"Canceled"}),(0,t.jsx)(b.Ql,{value:"past_due",children:"Past Due"})]})]})]}),n?(0,t.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,t.jsx)(y.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"rounded-md border",children:(0,t.jsxs)(v.iA,{children:[(0,t.jsx)(v.xD,{children:(0,t.jsxs)(v.SC,{children:[(0,t.jsx)(v.ss,{children:"User"}),(0,t.jsx)(v.ss,{children:"Plan"}),(0,t.jsx)(v.ss,{children:"Status"}),(0,t.jsx)(v.ss,{children:"Usage"}),(0,t.jsx)(v.ss,{children:"Joined"}),(0,t.jsx)(v.ss,{children:"Last Active"}),(0,t.jsx)(v.ss,{className:"text-right",children:"Actions"})]})}),(0,t.jsx)(v.RM,{children:a.map(e=>(0,t.jsxs)(v.SC,{children:[(0,t.jsx)(v.pj,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.name||"No name"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.email})]})}),(0,t.jsx)(v.pj,{children:(0,t.jsxs)(b.Ph,{value:e.plan_slug,onValueChange:s=>O(e.id,s),disabled:Q==="plan-".concat(e.id),children:[(0,t.jsx)(b.i4,{className:"w-[140px]",children:(0,t.jsx)(b.ki,{})}),(0,t.jsxs)(b.Bw,{children:[(0,t.jsx)(b.Ql,{value:"free",children:"Free"}),(0,t.jsx)(b.Ql,{value:"starter",children:"Developer"}),(0,t.jsx)(b.Ql,{value:"professional",children:"Professional"}),(0,t.jsx)(b.Ql,{value:"enterprise",children:"Enterprise"})]})]})}),(0,t.jsx)(v.pj,{children:D(e.subscription_status)}),(0,t.jsx)(v.pj,{children:(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("div",{children:[e.api_calls_count.toLocaleString()," calls"]}),(0,t.jsx)("div",{className:"text-muted-foreground",children:e.calls_remaining})]})}),(0,t.jsx)(v.pj,{className:"text-sm",children:(0,_.Q)(new Date(e.created_at),{addSuffix:!0})}),(0,t.jsx)(v.pj,{className:"text-sm",children:e.last_active?(0,_.Q)(new Date(e.last_active),{addSuffix:!0}):"Never"}),(0,t.jsx)(v.pj,{className:"text-right",children:(0,t.jsxs)(P.h_,{children:[(0,t.jsx)(P.$F,{asChild:!0,children:(0,t.jsx)(o.z,{variant:"ghost",size:"sm",children:(0,t.jsx)(k,{className:"h-4 w-4"})})}),(0,t.jsxs)(P.AW,{align:"end",children:[(0,t.jsx)(P.Ju,{children:"Actions"}),(0,t.jsx)(P.VD,{}),(0,t.jsxs)(P.Xi,{onClick:()=>window.open("/admin/users/".concat(e.id),"_blank"),children:[(0,t.jsx)(S.Z,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.stripe_customer_id&&(0,t.jsxs)(P.Xi,{onClick:()=>window.open("https://dashboard.stripe.com/customers/".concat(e.stripe_customer_id),"_blank"),children:[(0,t.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"View in Stripe"]}),"active"===e.subscription_status&&(0,t.jsxs)(P.Xi,{onClick:()=>Y(e.id),className:"text-destructive",disabled:Q==="cancel-".concat(e.id),children:[(0,t.jsx)(C,{className:"h-4 w-4 mr-2"}),"Cancel Subscription"]})]})]})})]},e.id))})]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Page ",p," of ",U]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(o.z,{variant:"outline",size:"sm",onClick:()=>A(e=>Math.max(1,e-1)),disabled:1===p,children:[(0,t.jsx)(Z,{className:"h-4 w-4"}),"Previous"]}),(0,t.jsxs)(o.z,{variant:"outline",size:"sm",onClick:()=>A(e=>Math.min(U,e+1)),disabled:p===U,children:["Next",(0,t.jsx)(R.Z,{className:"h-4 w-4"})]})]})]})]})]})]})}var U=a(5302),T=a(5131),Q=a(2135),M=a(875),z=a(2093);function O(){let[e,s]=(0,l.useState)([]),[a,r]=(0,l.useState)(!0),[n,i]=(0,l.useState)(""),[d,x]=(0,l.useState)("all"),[u,h]=(0,l.useState)("all"),[f,j]=(0,l.useState)(null),[p,k]=(0,l.useState)([]),S=(0,l.useCallback)(async()=>{try{r(!0);let e=new URLSearchParams({search:n,tool:d,status:u}),a=await fetch("/api/admin/mcp-logs?".concat(e));if(a.ok){let e=await a.json();s(e.logs),k(e.tools||[])}}catch(e){console.error("Error loading MCP logs:",e)}finally{r(!1)}},[n,d,u]);(0,l.useEffect)(()=>{S()},[S]);let C=e=>{switch(e){case"success":return(0,t.jsx)(U.Z,{className:"h-4 w-4 text-green-500"});case"error":return(0,t.jsx)(T.Z,{className:"h-4 w-4 text-red-500"});case"timeout":return(0,t.jsx)(m.Z,{className:"h-4 w-4 text-yellow-500"});default:return null}},Z=e=>{j(f===e?null:e)};return(0,t.jsxs)(c.Zb,{children:[(0,t.jsx)(c.Ol,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c.ll,{children:"MCP Tool Logs"}),(0,t.jsx)(c.SZ,{children:"Monitor all MCP tool calls and diagnose issues"})]}),(0,t.jsxs)(o.z,{onClick:S,size:"sm",variant:"outline",children:[(0,t.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),(0,t.jsxs)(c.aY,{children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,t.jsx)(N.I,{placeholder:"Search by user or error message...",value:n,onChange:e=>i(e.target.value),className:"pl-10"})]})}),(0,t.jsxs)(b.Ph,{value:d,onValueChange:x,children:[(0,t.jsx)(b.i4,{className:"w-[200px]",children:(0,t.jsx)(b.ki,{placeholder:"Filter by tool"})}),(0,t.jsxs)(b.Bw,{children:[(0,t.jsx)(b.Ql,{value:"all",children:"All Tools"}),p.map(e=>(0,t.jsx)(b.Ql,{value:e,children:e},e))]})]}),(0,t.jsxs)(b.Ph,{value:u,onValueChange:h,children:[(0,t.jsx)(b.i4,{className:"w-[150px]",children:(0,t.jsx)(b.ki,{placeholder:"Filter by status"})}),(0,t.jsxs)(b.Bw,{children:[(0,t.jsx)(b.Ql,{value:"all",children:"All Status"}),(0,t.jsx)(b.Ql,{value:"success",children:"Success"}),(0,t.jsx)(b.Ql,{value:"error",children:"Error"}),(0,t.jsx)(b.Ql,{value:"timeout",children:"Timeout"})]})]})]}),a?(0,t.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,t.jsx)(y.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,t.jsx)("div",{className:"rounded-md border",children:(0,t.jsxs)(v.iA,{children:[(0,t.jsx)(v.xD,{children:(0,t.jsxs)(v.SC,{children:[(0,t.jsx)(v.ss,{className:"w-[40px]"}),(0,t.jsx)(v.ss,{children:"User"}),(0,t.jsx)(v.ss,{children:"Tool"}),(0,t.jsx)(v.ss,{children:"Status"}),(0,t.jsx)(v.ss,{children:"Response Time"}),(0,t.jsx)(v.ss,{children:"Tokens"}),(0,t.jsx)(v.ss,{children:"Timestamp"})]})}),(0,t.jsx)(v.RM,{children:e.map(e=>(0,t.jsxs)(l.Fragment,{children:[(0,t.jsxs)(v.SC,{className:"cursor-pointer",onClick:()=>Z(e.id),children:[(0,t.jsx)(v.pj,{children:f===e.id?(0,t.jsx)(Q.Z,{className:"h-4 w-4"}):(0,t.jsx)(M.Z,{className:"h-4 w-4"})}),(0,t.jsx)(v.pj,{children:(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("div",{className:"font-medium",children:e.user_name||"Unknown"}),(0,t.jsx)("div",{className:"text-muted-foreground",children:e.user_email})]})}),(0,t.jsx)(v.pj,{children:(0,t.jsx)("code",{className:"text-sm bg-muted px-2 py-1 rounded",children:e.tool_name})}),(0,t.jsx)(v.pj,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[C(e.status),(0,t.jsx)("span",{className:"text-sm capitalize",children:e.status})]})}),(0,t.jsx)(v.pj,{children:(0,t.jsxs)("span",{className:"text-sm",children:[e.response_time_ms,"ms"]})}),(0,t.jsx)(v.pj,{children:e.tokens_used?(0,t.jsx)(g.C,{variant:"secondary",children:e.tokens_used}):(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"-"})}),(0,t.jsx)(v.pj,{children:(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("div",{children:(0,z.WU)(new Date(e.timestamp),"MMM d, HH:mm")}),(0,t.jsx)("div",{className:"text-muted-foreground",children:(0,_.Q)(new Date(e.timestamp),{addSuffix:!0})})]})})]}),f===e.id&&(0,t.jsx)(v.SC,{children:(0,t.jsx)(v.pj,{colSpan:7,className:"bg-muted/50",children:(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[e.error_message&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold text-sm mb-2",children:"Error Message"}),(0,t.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-200 p-3 rounded-md text-sm",children:e.error_message})]}),e.request_data&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold text-sm mb-2",children:"Request Data"}),(0,t.jsx)("pre",{className:"bg-background p-3 rounded-md text-xs overflow-x-auto",children:JSON.stringify(e.request_data,null,2)})]}),e.response_data&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold text-sm mb-2",children:"Response Data"}),(0,t.jsx)("pre",{className:"bg-background p-3 rounded-md text-xs overflow-x-auto max-h-64 overflow-y-auto",children:JSON.stringify(e.response_data,null,2)})]})]})})})]},e.id))})]})})]})]})}var Y=a(525);function D(){let[e,s]=(0,l.useState)(null),[a,r]=(0,l.useState)("7d"),[n,i]=(0,l.useState)(!0),d=(0,l.useCallback)(async()=>{try{i(!0);let e=await fetch("/api/admin/analytics?range=".concat(a));if(e.ok){let a=await e.json();s(a)}}catch(e){console.error("Error loading analytics:",e)}finally{i(!1)}},[a]);return((0,l.useEffect)(()=>{d()},[d]),n||!e)?(0,t.jsx)("div",{className:"grid gap-4",children:[1,2,3,4].map(e=>(0,t.jsx)(c.Zb,{children:(0,t.jsx)(c.aY,{className:"flex items-center justify-center py-8",children:(0,t.jsx)(y.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})})},e))}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Platform Analytics"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(b.Ph,{value:a,onValueChange:r,children:[(0,t.jsx)(b.i4,{className:"w-[180px]",children:(0,t.jsx)(b.ki,{})}),(0,t.jsxs)(b.Bw,{children:[(0,t.jsx)(b.Ql,{value:"24h",children:"Last 24 hours"}),(0,t.jsx)(b.Ql,{value:"7d",children:"Last 7 days"}),(0,t.jsx)(b.Ql,{value:"30d",children:"Last 30 days"}),(0,t.jsx)(b.Ql,{value:"90d",children:"Last 90 days"})]})]}),(0,t.jsx)(o.z,{onClick:d,size:"sm",variant:"outline",children:(0,t.jsx)(y.Z,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ll,{className:"text-sm font-medium",children:"Total API Calls"}),(0,t.jsx)(f.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:e.totalCalls.toLocaleString()}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"In selected period"})]})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ll,{className:"text-sm font-medium",children:"Active Users"}),(0,t.jsx)(h,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:e.uniqueUsers}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Unique users"})]})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ll,{className:"text-sm font-medium",children:"Avg Response Time"}),(0,t.jsx)(p.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.aY,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[Math.round(e.avgResponseTime),"ms"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Average latency"})]})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ll,{className:"text-sm font-medium",children:"Success Rate"}),(0,t.jsx)(Y.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.aY,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[e.successRate.toFixed(1),"%"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"API reliability"})]})]})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{children:[(0,t.jsx)(c.ll,{children:"Top MCP Tools"}),(0,t.jsx)(c.SZ,{children:"Most frequently used tools"})]}),(0,t.jsx)(c.aY,{children:(0,t.jsx)("div",{className:"space-y-3",children:e.topTools.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-sm font-medium text-muted-foreground",children:["#",s+1]}),(0,t.jsx)("code",{className:"text-sm bg-muted px-2 py-1 rounded",children:e.tool})]}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[e.count.toLocaleString()," calls"]})]},e.tool))})})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{children:[(0,t.jsx)(c.ll,{children:"Top Users"}),(0,t.jsx)(c.SZ,{children:"Most active platform users"})]}),(0,t.jsx)(c.aY,{children:(0,t.jsx)("div",{className:"space-y-3",children:e.topUsers.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-sm font-medium text-muted-foreground",children:["#",s+1]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:e.name||"Unknown"}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.email})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-sm font-medium",children:[e.count.toLocaleString()," calls"]}),(0,t.jsx)(g.C,{variant:"secondary",className:"text-xs",children:e.plan})]})]},e.email))})})]})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{children:[(0,t.jsx)(c.ll,{children:"Usage by Plan"}),(0,t.jsx)(c.SZ,{children:"API usage distribution across subscription tiers"})]}),(0,t.jsx)(c.aY,{children:(0,t.jsx)("div",{className:"space-y-4",children:e.planDistribution.map(s=>{let a=e.totalCalls>0?(s.calls/e.totalCalls*100).toFixed(1):"0";return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-medium capitalize",children:s.plan}),(0,t.jsxs)(g.C,{variant:"outline",children:[s.users," users"]})]}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[s.calls.toLocaleString()," calls (",a,"%)"]})]}),(0,t.jsx)("div",{className:"w-full bg-secondary rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:"".concat(a,"%")}})})]},s.plan)})})})]})]})}function V(){let{user:e,isLoading:s}=(0,r.aF)(),a=(0,n.useRouter)(),[u,v]=(0,l.useState)(!1),[g,N]=(0,l.useState)(!0),[b,y]=(0,l.useState)({totalUsers:0,activeUsers:0,totalRevenue:0,totalApiCalls:0}),w=(0,l.useCallback)(async()=>{try{let e=await fetch("/api/admin/check");if(e.ok){let s=await e.json();v(s.isAdmin)}else a.push("/dashboard")}catch(e){console.error("Error checking admin status:",e),a.push("/dashboard")}finally{N(!1)}},[a]),k=(0,l.useCallback)(async()=>{try{let e=await fetch("/api/admin/stats");if(e.ok){let s=await e.json();y(s)}}catch(e){console.error("Error loading stats:",e)}},[]);return((0,l.useEffect)(()=>{e&&!s&&(w(),k())},[e,s,w,k]),s||g)?(0,t.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,t.jsx)(i.Header,{}),(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})]}):e&&u?(0,t.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,t.jsx)(i.Header,{}),(0,t.jsx)("div",{className:"flex-1 bg-background",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Admin Dashboard"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2",children:"Manage users, monitor usage, and configure the platform."})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-4 mb-8",children:[(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ll,{className:"text-sm font-medium",children:"Total Users"}),(0,t.jsx)(h,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:b.totalUsers.toLocaleString()}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Registered accounts"})]})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ll,{className:"text-sm font-medium",children:"Active Users"}),(0,t.jsx)(f.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:b.activeUsers.toLocaleString()}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"With active subscriptions"})]})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ll,{className:"text-sm font-medium",children:"Monthly Revenue"}),(0,t.jsx)(j.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.aY,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:["$",(b.totalRevenue/100).toLocaleString()]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Recurring revenue"})]})]}),(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(c.ll,{className:"text-sm font-medium",children:"API Calls (30d)"}),(0,t.jsx)(p.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(c.aY,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:b.totalApiCalls.toLocaleString()}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total platform usage"})]})]})]}),(0,t.jsxs)(d.mQ,{defaultValue:"users",className:"space-y-4",children:[(0,t.jsxs)(d.dr,{children:[(0,t.jsx)(d.SP,{value:"users",children:"Users"}),(0,t.jsx)(d.SP,{value:"analytics",children:"Analytics"}),(0,t.jsx)(d.SP,{value:"logs",children:"MCP Logs"}),(0,t.jsx)(d.SP,{value:"settings",children:"Settings"})]}),(0,t.jsx)(d.nU,{value:"users",className:"space-y-4",children:(0,t.jsx)(A,{onUpdate:k})}),(0,t.jsx)(d.nU,{value:"analytics",className:"space-y-4",children:(0,t.jsx)(D,{})}),(0,t.jsx)(d.nU,{value:"logs",className:"space-y-4",children:(0,t.jsx)(O,{})}),(0,t.jsx)(d.nU,{value:"settings",className:"space-y-4",children:(0,t.jsxs)(c.Zb,{children:[(0,t.jsxs)(c.Ol,{children:[(0,t.jsx)(c.ll,{children:"Platform Settings"}),(0,t.jsx)(c.SZ,{children:"Configure global platform settings and integrations."})]}),(0,t.jsx)(c.aY,{children:(0,t.jsxs)(x.bZ,{children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)(x.X,{children:"Settings management coming soon. Use the database directly for now."})]})})]})})]})]})})]}):(0,t.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,t.jsx)(i.Header,{}),(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,t.jsx)(c.Zb,{className:"max-w-md",children:(0,t.jsx)(c.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,t.jsx)(m.Z,{className:"h-12 w-12 text-destructive mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Access Denied"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:"You don't have permission to access the admin dashboard."}),(0,t.jsx)(o.z,{onClick:()=>a.push("/dashboard"),children:"Return to Dashboard"})]})})})})]})}},5937:function(e,s,a){"use strict";a.d(s,{X:function(){return d},bZ:function(){return c}});var t=a(7437),l=a(2265),r=a(535),n=a(3448);let i=(0,r.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=l.forwardRef((e,s)=>{let{className:a,variant:l,...r}=e;return(0,t.jsx)("div",{ref:s,role:"alert",className:(0,n.cn)(i({variant:l}),a),...r})});c.displayName="Alert",l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("h5",{ref:s,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",a),...l})}).displayName="AlertTitle";let d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",a),...l})});d.displayName="AlertDescription"},9174:function(e,s,a){"use strict";a.d(s,{C:function(){return i}});var t=a(7437);a(2265);var l=a(535),r=a(3448);let n=(0,l.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:a,...l}=e;return(0,t.jsx)("div",{className:(0,r.cn)(n({variant:a}),s),...l})}},9820:function(e,s,a){"use strict";a.d(s,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return n},aY:function(){return o},ll:function(){return c}});var t=a(7437),l=a(2265),r=a(3448);let n=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...l})});n.displayName="Card";let i=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...l})});i.displayName="CardHeader";let c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("h3",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a),...l})});c.displayName="CardTitle";let d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("p",{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",a),...l})});d.displayName="CardDescription";let o=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",a),...l})});o.displayName="CardContent",l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",a),...l})}).displayName="CardFooter"},279:function(e,s,a){"use strict";a.d(s,{I:function(){return n}});var t=a(7437),l=a(2265),r=a(3448);let n=l.forwardRef((e,s)=>{let{className:a,type:l,...n}=e;return(0,t.jsx)("input",{type:l,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...n})});n.displayName="Input"},5291:function(e,s,a){"use strict";a.d(s,{Bw:function(){return f},Ph:function(){return o},Ql:function(){return j},i4:function(){return m},ki:function(){return x}});var t=a(7437),l=a(2265),r=a(7265),n=a(875),i=a(2135),c=a(401),d=a(3448);let o=r.fC;r.ZA;let x=r.B4,m=l.forwardRef((e,s)=>{let{className:a,children:l,...i}=e;return(0,t.jsxs)(r.xz,{ref:s,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[l,(0,t.jsx)(r.JO,{asChild:!0,children:(0,t.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=r.xz.displayName;let u=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.u_,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,t.jsx)(i.Z,{className:"h-4 w-4"})})});u.displayName=r.u_.displayName;let h=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.$G,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,t.jsx)(n.Z,{className:"h-4 w-4"})})});h.displayName=r.$G.displayName;let f=l.forwardRef((e,s)=>{let{className:a,children:l,position:n="popper",...i}=e;return(0,t.jsx)(r.h_,{children:(0,t.jsxs)(r.VY,{ref:s,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...i,children:[(0,t.jsx)(u,{}),(0,t.jsx)(r.l_,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,t.jsx)(h,{})]})})});f.displayName=r.VY.displayName,l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.__,{ref:s,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...l})}).displayName=r.__.displayName;let j=l.forwardRef((e,s)=>{let{className:a,children:l,...n}=e;return(0,t.jsxs)(r.ck,{ref:s,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(r.wU,{children:(0,t.jsx)(c.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(r.eT,{children:l})]})});j.displayName=r.ck.displayName,l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.Z0,{ref:s,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...l})}).displayName=r.Z0.displayName},3804:function(e,s,a){"use strict";a.d(s,{RM:function(){return c},SC:function(){return d},iA:function(){return n},pj:function(){return x},ss:function(){return o},xD:function(){return i}});var t=a(7437),l=a(2265),r=a(3448);let n=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:s,className:(0,r.cn)("w-full caption-bottom text-sm",a),...l})})});n.displayName="Table";let i=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("thead",{ref:s,className:(0,r.cn)("[&_tr]:border-b",a),...l})});i.displayName="TableHeader";let c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("tbody",{ref:s,className:(0,r.cn)("[&_tr:last-child]:border-0",a),...l})});c.displayName="TableBody",l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("tfoot",{ref:s,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...l})}).displayName="TableFooter";let d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("tr",{ref:s,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...l})});d.displayName="TableRow";let o=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("th",{ref:s,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...l})});o.displayName="TableHead";let x=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("td",{ref:s,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...l})});x.displayName="TableCell",l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)("caption",{ref:s,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",a),...l})}).displayName="TableCaption"},7168:function(e,s,a){"use strict";a.d(s,{SP:function(){return d},dr:function(){return c},mQ:function(){return i},nU:function(){return o}});var t=a(7437),l=a(2265),r=a(271),n=a(3448);let i=r.fC,c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.aV,{ref:s,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...l})});c.displayName=r.aV.displayName;let d=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.xz,{ref:s,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...l})});d.displayName=r.xz.displayName;let o=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(r.VY,{ref:s,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...l})});o.displayName=r.VY.displayName}},function(e){e.O(0,[624,656,548,793,993,851,518,971,117,744],function(){return e(e.s=7799)}),_N_E=e.O()}]);